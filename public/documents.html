<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>T√†i li·ªáu An to√†n Lao ƒë·ªông | B√†i gi·∫£ng & VƒÉn b·∫£n ph√°p lu·∫≠t | ATLƒê Connect</title>

    <!-- PWA Meta Tags -->
    <meta name="description" content="T·∫£i mi·ªÖn ph√≠ t√†i li·ªáu, b√†i gi·∫£ng v√† vƒÉn b·∫£n ph√°p lu·∫≠t v·ªÅ an to√†n lao ƒë·ªông. Th∆∞ vi·ªán t√†i li·ªáu ATLƒê phong ph√∫, c·∫≠p nh·∫≠t th∆∞·ªùng xuy√™n t·∫°i ATLƒê Connect.">
    <meta name="keywords" content="t√†i li·ªáu an to√†n lao ƒë·ªông, b√†i gi·∫£ng atlƒë, vƒÉn b·∫£n ph√°p lu·∫≠t, quy ƒë·ªãnh an to√†n, h∆∞·ªõng d·∫´n ƒë√†o t·∫°o, lao ƒë·ªông">
    <meta name="theme-color" content="#dc2626">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://atld.web.app/documents.html">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://atld.web.app/documents.html">
    <meta property="og:title" content="T√†i li·ªáu An to√†n Lao ƒë·ªông | B√†i gi·∫£ng & VƒÉn b·∫£n ATLƒê">
    <meta property="og:description" content="T·∫£i mi·ªÖn ph√≠ t√†i li·ªáu, b√†i gi·∫£ng v√† vƒÉn b·∫£n ph√°p lu·∫≠t v·ªÅ ATLƒê. Th∆∞ vi·ªán t√†i li·ªáu phong ph√∫, c·∫≠p nh·∫≠t th∆∞·ªùng xuy√™n.">
    <meta property="og:image" content="https://atld.web.app/logo.png">
    <meta property="og:locale" content="vi_VN">

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="T√†i li·ªáu An to√†n Lao ƒë·ªông | ATLƒê Connect">
    <meta name="twitter:description" content="Th∆∞ vi·ªán t√†i li·ªáu ATLƒê mi·ªÖn ph√≠ - B√†i gi·∫£ng, vƒÉn b·∫£n ph√°p lu·∫≠t v√† t√†i li·ªáu chuy√™n ng√†nh.">
    <meta name="twitter:image" content="https://atld.web.app/logo.png">

    <link rel="manifest" href="/manifest.json">
    <link rel="icon" type="image/png" href="/logo.png">
    <link rel="apple-touch-icon" href="/logo.png">

    <link rel="preload" href="styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="styles.css"></noscript>

    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-storage-compat.js"></script>

    <style>
        .documents-section {
            padding: 60px 0;
            background-color: var(--light-color);
        }

        .documents-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .section-intro {
            text-align: center;
            margin-bottom: 3rem;
        }

        .section-intro h2 {
            font-size: 2rem;
            color: var(--dark-color);
            margin-bottom: 1rem;
        }

        .section-intro p {
            font-size: 1.1rem;
            color: var(--gray-color);
        }

        .documents-filter {
            background: white;
            padding: 1.5rem;
            border-radius: 12px;
            box-shadow: var(--shadow);
            margin-bottom: 2rem;
        }

        .filter-tabs {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            justify-content: center;
        }

        .filter-tab {
            padding: 10px 24px;
            border: 2px solid var(--gray-light);
            background: white;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }

        .filter-tab:hover,
        .filter-tab.active {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        .documents-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 2rem;
            margin-bottom: 3rem;
        }

        .document-card {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: all 0.3s;
        }

        .document-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }

        .document-header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            padding: 1rem;
            color: white;
        }

        .document-icon {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }

        .document-type {
            font-size: 0.85rem;
            opacity: 0.9;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .document-body {
            padding: 1.5rem;
        }

        .document-title {
            font-size: 1.25rem;
            color: var(--dark-color);
            margin-bottom: 0.75rem;
            font-weight: 600;
        }

        .document-description {
            color: var(--gray-color);
            font-size: 0.95rem;
            margin-bottom: 1rem;
            line-height: 1.6;
        }

        .document-meta {
            display: flex;
            gap: 1rem;
            font-size: 0.85rem;
            color: var(--gray-color);
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }

        .document-meta span {
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .document-footer {
            display: flex;
            gap: 0.75rem;
            padding-top: 1rem;
            border-top: 1px solid var(--gray-light);
        }

        .btn-download {
            flex: 1;
            background: var(--primary-color);
            color: white;
            padding: 10px;
            border-radius: 8px;
            text-align: center;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s;
        }

        .btn-download:hover {
            background: var(--secondary-color);
            transform: translateY(-2px);
        }

        .btn-view {
            flex: 1;
            background: white;
            color: var(--primary-color);
            padding: 10px;
            border: 2px solid var(--primary-color);
            border-radius: 8px;
            text-align: center;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s;
        }

        .btn-view:hover {
            background: var(--primary-color);
            color: white;
        }

        .empty-state {
            text-align: center;
            padding: 4rem 2rem;
            background: white;
            border-radius: 12px;
            box-shadow: var(--shadow);
        }

        .empty-state-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
        }

        .empty-state h3 {
            font-size: 1.5rem;
            color: var(--dark-color);
            margin-bottom: 0.5rem;
        }

        .empty-state p {
            color: var(--gray-color);
            font-size: 1rem;
        }

        .upload-section {
            background: white;
            padding: 2rem;
            border-radius: 12px;
            box-shadow: var(--shadow);
            margin-bottom: 3rem;
            display: none;
        }

        .upload-section.admin-visible {
            display: block;
        }

        .upload-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid var(--gray-light);
        }

        .upload-header h3 {
            font-size: 1.5rem;
            color: var(--dark-color);
        }

        .upload-form {
            display: grid;
            gap: 1.5rem;
        }

        @media (max-width: 768px) {
            .documents-grid {
                grid-template-columns: 1fr;
            }

            .filter-tabs {
                flex-direction: column;
            }

            .document-footer {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="container">
            <div class="logo">ATLƒê Connect</div>
            <ul class="nav-menu">
                <li><a href="index.html">Trang ch·ªß</a></li>
                <li><a href="courses.html">Kh√≥a h·ªçc</a></li>
                <li><a href="documents.html" class="active">T√†i li·ªáu</a></li>
                <li><a href="index.html#how-it-works">C√°ch th·ª©c</a></li>
                <li><a href="index.html#about">Gi·ªõi thi·ªáu</a></li>
                <li><a href="post-request.html" class="btn-nav">ƒêƒÉng k√Ω ƒë√†o t·∫°o</a></li>
                <li><a href="partner-register.html" class="btn-nav-partner">ƒê·ªëi t√°c</a></li>
            </ul>
            <div class="hamburger">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
    </nav>

    <!-- Page Header -->
    <section class="page-header">
        <div class="container">
            <h1>üìö T√†i li·ªáu h·ªçc t·∫≠p</h1>
            <p>T√†i li·ªáu, b√†i gi·∫£ng v√† t∆∞ li·ªáu chuy√™n ng√†nh An to√†n Lao ƒë·ªông</p>
        </div>
    </section>

    <!-- Documents Section -->
    <section class="documents-section">
        <div class="documents-container">
            <!-- Admin Upload Section (only visible when logged in) -->
            <div class="upload-section" id="upload-section">
                <div class="upload-header">
                    <h3>üì§ Upload t√†i li·ªáu m·ªõi</h3>
                    <a href="admin-dashboard.html" class="btn btn-small btn-primary">Admin Dashboard</a>
                </div>
                <form class="upload-form" id="upload-form">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="doc-title">Ti√™u ƒë·ªÅ t√†i li·ªáu <span class="required">*</span></label>
                            <input type="text" id="doc-title" required placeholder="VD: H∆∞·ªõng d·∫´n an to√†n ƒëi·ªán">
                        </div>
                        <div class="form-group">
                            <label for="doc-category">Danh m·ª•c <span class="required">*</span></label>
                            <select id="doc-category" required>
                                <option value="">-- Ch·ªçn danh m·ª•c --</option>
                                <option value="general">An to√†n chung</option>
                                <option value="construction">X√¢y d·ª±ng</option>
                                <option value="electrical">ƒêi·ªán</option>
                                <option value="fire">Ph√≤ng ch√°y ch·ªØa ch√°y</option>
                                <option value="chemical">H√≥a ch·∫•t</option>
                                <option value="manufacturing">S·∫£n xu·∫•t</option>
                                <option value="regulations">VƒÉn b·∫£n ph√°p lu·∫≠t</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="doc-description">M√¥ t·∫£</label>
                        <textarea id="doc-description" rows="3" placeholder="M√¥ t·∫£ ng·∫Øn g·ªçn v·ªÅ t√†i li·ªáu"></textarea>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="doc-file">File t√†i li·ªáu <span class="required">*</span></label>
                            <input type="file" id="doc-file" required accept=".pdf,.doc,.docx,.ppt,.pptx,.xls,.xlsx">
                        </div>
                        <div class="form-group">
                            <label for="doc-pages">S·ªë trang</label>
                            <input type="number" id="doc-pages" placeholder="VD: 25">
                        </div>
                    </div>
                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary">üì§ Upload t√†i li·ªáu</button>
                    </div>
                </form>
            </div>

            <!-- Section Intro -->
            <div class="section-intro">
                <h2>Th∆∞ vi·ªán t√†i li·ªáu</h2>
                <p>T·ªïng h·ª£p t√†i li·ªáu, b√†i gi·∫£ng v√† vƒÉn b·∫£n ph√°p lu·∫≠t v·ªÅ An to√†n Lao ƒë·ªông</p>
            </div>

            <!-- Filter Tabs -->
            <div class="documents-filter">
                <div class="filter-tabs">
                    <button class="filter-tab active" data-category="all">T·∫•t c·∫£</button>
                    <button class="filter-tab" data-category="general">An to√†n chung</button>
                    <button class="filter-tab" data-category="construction">X√¢y d·ª±ng</button>
                    <button class="filter-tab" data-category="electrical">ƒêi·ªán</button>
                    <button class="filter-tab" data-category="fire">PCCC</button>
                    <button class="filter-tab" data-category="chemical">H√≥a ch·∫•t</button>
                    <button class="filter-tab" data-category="manufacturing">S·∫£n xu·∫•t</button>
                    <button class="filter-tab" data-category="regulations">VƒÉn b·∫£n ph√°p lu·∫≠t</button>
                </div>
            </div>

            <!-- Loading -->
            <div id="loading" style="text-align: center; padding: 3rem;">
                <p style="color: var(--gray-color);">ƒêang t·∫£i t√†i li·ªáu...</p>
            </div>

            <!-- Documents Grid -->
            <div class="documents-grid" id="documents-grid" style="display: none;">
                <!-- Documents will be loaded here -->
            </div>

            <!-- Empty State -->
            <div class="empty-state" id="empty-state" style="display: none;">
                <div class="empty-state-icon">üìö</div>
                <h3>Ch∆∞a c√≥ t√†i li·ªáu</h3>
                <p>T√†i li·ªáu s·∫Ω ƒë∆∞·ª£c c·∫≠p nh·∫≠t s·ªõm. Vui l√≤ng quay l·∫°i sau!</p>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>ATLƒê Connect</h3>
                    <p>N·ªÅn t·∫£ng k·∫øt n·ªëi ƒë√†o t·∫°o An to√†n Lao ƒë·ªông h√†ng ƒë·∫ßu Vi·ªát Nam</p>
                </div>
                <div class="footer-section">
                    <h4>Li√™n k·∫øt</h4>
                    <ul>
                        <li><a href="index.html">Trang ch·ªß</a></li>
                        <li><a href="courses.html">Kh√≥a h·ªçc</a></li>
                        <li><a href="documents.html">T√†i li·ªáu</a></li>
                        <li><a href="index.html#how-it-works">C√°ch th·ª©c ho·∫°t ƒë·ªông</a></li>
                        <li><a href="index.html#about">Gi·ªõi thi·ªáu</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>D√†nh cho</h4>
                    <ul>
                        <li><a href="post-request.html">ƒêƒÉng k√Ω ƒë√†o t·∫°o</a></li>
                        <li><a href="partner-register.html">ƒê·ªëi t√°c ƒë√†o t·∫°o</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>Li√™n h·ªá</h4>
                    <ul>
                        <li>Email: vietthanh228@gmail.com</li>
                        <li>Hotline: 0982 722 036</li>
                        <li>ƒê·ªãa ch·ªâ: 135 N√∫i Tr√∫c, Gi·∫£ng V√µ, H√† N·ªôi</li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 ATLƒê Connect. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script src="script.js"></script>
    <script src="firebase-config.js"></script>
    <script>
        // Category Icons
        const categoryIcons = {
            general: 'üìã',
            construction: 'üèóÔ∏è',
            electrical: '‚ö°',
            fire: 'üî•',
            chemical: 'üß™',
            manufacturing: 'üè≠',
            regulations: 'üìú'
        };

        // Category Names
        const categoryNames = {
            general: 'An to√†n chung',
            construction: 'X√¢y d·ª±ng',
            electrical: 'ƒêi·ªán',
            fire: 'Ph√≤ng ch√°y ch·ªØa ch√°y',
            chemical: 'H√≥a ch·∫•t',
            manufacturing: 'S·∫£n xu·∫•t',
            regulations: 'VƒÉn b·∫£n ph√°p lu·∫≠t'
        };

        // Check if admin
        window.FirebaseHelper.onAuthStateChanged((user) => {
            if (user) {
                document.getElementById('upload-section').classList.add('admin-visible');
            }
        });

        // Sample documents (replace with Firebase data later)
        const sampleDocuments = [
            {
                id: '1',
                title: 'H∆∞·ªõng d·∫´n an to√†n ƒëi·ªán c∆° b·∫£n',
                description: 'T√†i li·ªáu h∆∞·ªõng d·∫´n c√°c nguy√™n t·∫Øc an to√†n khi l√†m vi·ªác v·ªõi ƒëi·ªán',
                category: 'electrical',
                fileType: 'PDF',
                pages: 35,
                size: '2.5 MB',
                date: '2025-01-15',
                downloadUrl: '#'
            },
            {
                id: '2',
                title: 'An to√†n lao ƒë·ªông trong x√¢y d·ª±ng',
                description: 'Quy tr√¨nh v√† ti√™u chu·∫©n an to√†n cho c√¥ng tr∆∞·ªùng x√¢y d·ª±ng',
                category: 'construction',
                fileType: 'PDF',
                pages: 48,
                size: '3.8 MB',
                date: '2025-01-10',
                downloadUrl: '#'
            },
            {
                id: '3',
                title: 'Lu·∫≠t an to√†n lao ƒë·ªông 2025',
                description: 'VƒÉn b·∫£n ph√°p lu·∫≠t v·ªÅ an to√†n v·ªá sinh lao ƒë·ªông m·ªõi nh·∫•t',
                category: 'regulations',
                fileType: 'PDF',
                pages: 120,
                size: '5.2 MB',
                date: '2025-01-05',
                downloadUrl: '#'
            },
            {
                id: '4',
                title: 'H∆∞·ªõng d·∫´n ph√≤ng ch√°y ch·ªØa ch√°y',
                description: 'Ki·∫øn th·ª©c c∆° b·∫£n v·ªÅ PCCC v√† s·ª≠ d·ª•ng thi·∫øt b·ªã ch·ªØa ch√°y',
                category: 'fire',
                fileType: 'PowerPoint',
                pages: 25,
                size: '4.1 MB',
                date: '2025-01-03',
                downloadUrl: '#'
            },
            {
                id: '5',
                title: 'An to√†n khi l√†m vi·ªác v·ªõi h√≥a ch·∫•t',
                description: 'H∆∞·ªõng d·∫´n x·ª≠ l√Ω, b·∫£o qu·∫£n v√† s·ª≠ d·ª•ng h√≥a ch·∫•t an to√†n',
                category: 'chemical',
                fileType: 'PDF',
                pages: 42,
                size: '3.2 MB',
                date: '2024-12-28',
                downloadUrl: '#'
            },
            {
                id: '6',
                title: 'An to√†n m√°y m√≥c trong s·∫£n xu·∫•t',
                description: 'Quy tr√¨nh v·∫≠n h√†nh m√°y m√≥c an to√†n trong nh√† m√°y',
                category: 'manufacturing',
                fileType: 'PDF',
                pages: 38,
                size: '2.9 MB',
                date: '2024-12-20',
                downloadUrl: '#'
            }
        ];

        let currentCategory = 'all';
        let documents = [];

        // Load documents from Firebase
        async function loadDocuments() {
            const loading = document.getElementById('loading');
            const grid = document.getElementById('documents-grid');
            const emptyState = document.getElementById('empty-state');

            loading.style.display = 'block';
            grid.style.display = 'none';
            emptyState.style.display = 'none';

            try {
                const snapshot = await firebase.firestore()
                    .collection('documents')
                    .orderBy('uploadedAt', 'desc')
                    .get();

                documents = snapshot.docs.map(doc => {
                    const data = doc.data();
                    return {
                        id: doc.id,
                        title: data.title,
                        description: data.description || '',
                        category: data.category,
                        fileType: data.fileType,
                        pages: data.pages || 0,
                        size: formatFileSize(data.fileSize),
                        downloadUrl: data.downloadURL,
                        downloadCount: data.downloadCount || 0,
                        date: data.uploadedAt ? new Date(data.uploadedAt.toDate()).toLocaleDateString('vi-VN') : 'N/A'
                    };
                });

                // If no documents from Firebase, use sample data
                if (documents.length === 0) {
                    documents = sampleDocuments;
                }

                renderDocuments();
            } catch (error) {
                console.error('Error loading documents:', error);
                // Fallback to sample data
                documents = sampleDocuments;
                renderDocuments();
            }
        }

        function formatFileSize(bytes) {
            if (!bytes || bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return Math.round(bytes / Math.pow(k, i) * 100) / 100 + ' ' + sizes[i];
        }

        // Render documents
        function renderDocuments() {
            const grid = document.getElementById('documents-grid');
            const loading = document.getElementById('loading');
            const emptyState = document.getElementById('empty-state');

            const filtered = currentCategory === 'all'
                ? documents
                : documents.filter(doc => doc.category === currentCategory);

            loading.style.display = 'none';

            if (filtered.length === 0) {
                grid.style.display = 'none';
                emptyState.style.display = 'block';
                return;
            }

            emptyState.style.display = 'none';
            grid.style.display = 'grid';
            grid.innerHTML = '';

            filtered.forEach(doc => {
                const card = document.createElement('div');
                card.className = 'document-card';
                card.innerHTML = `
                    <div class="document-header">
                        <div class="document-icon">${categoryIcons[doc.category]}</div>
                        <div class="document-type">${categoryNames[doc.category]}</div>
                    </div>
                    <div class="document-body">
                        <h3 class="document-title">${doc.title}</h3>
                        <p class="document-description">${doc.description}</p>
                        <div class="document-meta">
                            <span>üìÑ ${doc.fileType}</span>
                            <span>üìÉ ${doc.pages} trang</span>
                            <span>üíæ ${doc.size}</span>
                            ${doc.downloadCount ? `<span>üì• ${doc.downloadCount} l∆∞·ª£t t·∫£i</span>` : ''}
                        </div>
                        <div class="document-footer">
                            <a href="${doc.downloadUrl}" class="btn-download" data-doc-id="${doc.id}" download>T·∫£i xu·ªëng</a>
                            <a href="${doc.downloadUrl}" class="btn-view" target="_blank">Xem tr∆∞·ªõc</a>
                        </div>
                    </div>
                `;
                grid.appendChild(card);

                // Add click event to track downloads
                const downloadBtn = card.querySelector('.btn-download');
                downloadBtn.addEventListener('click', () => trackDownload(doc.id));
            });
        }

        // Filter tabs
        document.querySelectorAll('.filter-tab').forEach(tab => {
            tab.addEventListener('click', () => {
                document.querySelectorAll('.filter-tab').forEach(t => t.classList.remove('active'));
                tab.classList.add('active');
                currentCategory = tab.dataset.category;
                renderDocuments();
            });
        });

        // Upload form (redirect to admin page)
        document.getElementById('upload-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            alert('Vui l√≤ng ƒëƒÉng nh·∫≠p Admin ƒë·ªÉ upload t√†i li·ªáu!');
            window.location.href = 'admin-login.html';
        });

        // Track download
        async function trackDownload(docId) {
            if (!docId) return;

            try {
                const docRef = firebase.firestore().collection('documents').doc(docId);

                // Increment download count
                await docRef.update({
                    downloadCount: firebase.firestore.FieldValue.increment(1)
                });

                console.log('Download tracked for document:', docId);
            } catch (error) {
                console.error('Error tracking download:', error);
                // Don't block download if tracking fails
            }
        }

        // Initial load
        loadDocuments();
    </script>

    <!-- PWA Service Worker -->
    <script>
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('/service-worker.js')
                .then(reg => console.log('Service Worker registered'))
                .catch(err => console.log('Service Worker registration failed'));
        }
    </script>
</body>
</html>
